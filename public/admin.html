<!DOCTYPE html>
<html lang="en">
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="dashboard">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h1>Admin Dashboard</h1>
            <button onclick="logout()" style="background:red;">Logout</button>
        </div>

        <div class="payment-container" style="text-align:left;">
            <h3>âž• Add New Fee Type</h3>
            <input type="text" id="new-fee-name" placeholder="Fee Name (e.g., Breakage Fee)">
            <input type="number" id="new-fee-amount" placeholder="Amount">
            <button onclick="addFee()">Add Fee</button>
        </div>

        <div class="payment-container" style="text-align:left; margin-top: 20px;">
            <h3>ðŸ“œ Transaction History</h3>
            <table border="1" width="100%" style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Fee Type</th>
                        <th>Amount</th>
                        <th>Receipt</th>
                    </tr>
                </thead>
                <tbody id="tx-table">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        // Load Payments
        async function loadPayments() {
            const res = await fetch('/api/admin/payments');
            const data = await res.json();
            const tbody = document.getElementById('tx-table');
            tbody.innerHTML = '';
            data.forEach(tx => {
                tbody.innerHTML += `
                    <tr>
                        <td>${new Date(tx.PaymentDate).toLocaleDateString()}</td>
                        <td>${tx.FeeName}</td>
                        <td>â‚¹${tx.Amount}</td>
                        <td><a href="${tx.ReceiptURL}" target="_blank">View Receipt</a></td>
                    </tr>
                `;
            });
        }

        // Add Fee
        async function addFee() {
            const name = document.getElementById('new-fee-name').value;
            const amount = document.getElementById('new-fee-amount').value;
            await fetch('/api/admin/add-fee', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ feeName: name, amount })
            });
            alert('Fee Added!');
            location.reload();
        }

        function logout() {
            localStorage.clear();
            window.location.href = 'login.html';
        }

        loadPayments();
    </script>
</body>
</html>